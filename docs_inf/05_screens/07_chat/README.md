# 채팅 화면 (Chat Screens)

## 📁 파일 구조

```
07_chat/
├── README.md              # 개요 (이 파일)
├── chat-list.md           # 채팅방 목록 화면
└── chat-main.md           # 채팅 메인 화면
```

---

## 화면 목록

| 화면 | 파일 | 설명 |
|------|------|------|
| 채팅방 목록 | [chat-list.md](./chat-list.md) | 그룹/1:1 채팅방 목록 (사업장 단위) |
| 채팅 | [chat-main.md](./chat-main.md) | 채팅방 (카카오톡 스타일, 다양한 파일 지원) |

---

## 채팅 구조 (사업장 단위)

| 채팅 타입 | 설명 | 권한 |
|---------|------|-----|
| 그룹 채팅 | 사업장 전체 직원 참여 (사업장 생성 시 자동 생성) | 모든 멤버 |
| 1:1 채팅 | 관리자-직원 개별 대화 | 관리자: 생성 가능 / 직원: 참여만 |

---

## 핵심 기능

### 채팅방 목록
- 그룹 채팅방 (상단 고정, 사업장 생성 시 자동 생성)
- 1:1 채팅방 (관리자가 직원별로 생성 가능)
- 채팅방/메시지 검색
- 안읽음 메시지 뱃지

### 채팅방 (카카오톡 스타일)
- **타인 메시지**: 좌측 프로필 + 이름 + 버블 + 우측하단 읽지않은수/시간
- **내 메시지**: 우측 버블 + 좌측하단 읽지않은수/시간
- 메시지 검색 기능
- 다양한 파일 형식 지원 및 미리보기

### 지원 파일 형식
| 타입 | 확장자 | 용량 제한 | 미리보기 |
|-----|-------|---------|---------|
| 이미지 | jpg, jpeg, png, gif, webp, bmp, heic, svg, tiff, ico | 10MB | 썸네일, 전체화면 뷰어 |
| 동영상 | mp4, mov, avi, mkv, wmv, flv, webm, m4v, 3gp | 100MB | 썸네일 + 인라인 재생 |
| 오디오 | mp3, wav, aac, flac, m4a, ogg, wma | 20MB | 웨이브폼 + 인라인 재생 |
| 문서 | pdf, doc, docx, xls, xlsx, ppt, pptx, txt, hwp, hwpx, rtf, odt, ods, odp | 30MB | 문서 뷰어 |
| 코드 | js, ts, py, java, c, cpp, cs, html, css, json, xml, yaml, md | 5MB | 구문 강조 |
| 압축 | zip, rar, 7z, tar, gz | 50MB | 파일 목록 |

---

## 메시지 레이아웃 (카카오톡 스타일)

### 타인 메시지
```
┌────┐  이름
│프로│  ┌─────────────────┐
│필  │  │ 메시지 내용     │  읽지않은수
│    │  └─────────────────┘  시간
└────┘
```

### 내 메시지
```
            ┌─────────────────┐
읽지않은수  │ 메시지 내용     │
시간        └─────────────────┘
```

---

## 핵심 컴포넌트

| 컴포넌트 | 설명 |
|---------|------|
| SearchBar | 검색 입력 |
| ChatRoomItem | 채팅방 목록 아이템 |
| MessageBubble | 메시지 말풍선 (카카오톡 스타일) |
| DateSeparator | 날짜 구분선 |
| ImageMessage | 이미지 메시지 |
| FileMessage | 파일 메시지 |
| MessageInput | 메시지 입력창 |
| SearchOverlay | 메시지 검색 오버레이 |

---

## 권한별 차이

| 기능 | 근무자 | 관리자 |
|------|--------|--------|
| 전체 채팅방 | ✅ | ✅ |
| 1:1 채팅방 | ❌ | ✅ |
| 새 채팅 생성 | ❌ | ✅ |

---

## 읽지 않은 수 표시

- 채팅방 목록: 안읽은 메시지 총 개수
- 메시지 버블: 해당 메시지를 읽지 않은 유저 수
- 모두 읽음 시: 숫자 숨김

---

## 오프라인 지원

- 오프라인 시 메시지 로컬 저장
- 온라인 복귀 시 자동 동기화
- 전송 실패 시 재시도 버튼
