# 💬 1:1 및 그룹 채팅 (Direct Messaging)

## 개요

기존 스터디 채팅과 별개로 사용자 간 1:1 대화 및 자유 그룹 채팅방 기능을 제공합니다.
친구 시스템과 연동되어 친구에게 바로 메시지를 보낼 수 있습니다.

---

## 문서 구조

| 문서 | 설명 |
|------|------|
| [models.md](./models.md) | 데이터베이스 모델 정의 |
| [api.md](./api.md) | REST API 엔드포인트 명세 |
| [socket-events.md](./socket-events.md) | Socket.IO 실시간 이벤트 |
| [components.md](./components.md) | 프론트엔드 컴포넌트 구조 |
| [features.md](./features.md) | 세부 기능 명세 |
| [ui-design.md](./ui-design.md) | UI/UX 설계 |

---

## 주요 기능 요약

### 채팅방

| 기능 | 설명 |
|------|------|
| 1:1 채팅 | 특정 사용자와 개인 대화 |
| 그룹 채팅방 | 여러 사용자가 참여하는 채팅방 |
| 대화 고정 | 중요 대화 상단 고정 |
| 알림 설정 | 채팅방별 알림 ON/OFF |

### 메시지

| 기능 | 설명 |
|------|------|
| 텍스트 메시지 | 일반 텍스트 전송 |
| 이미지/파일 | 미디어 파일 전송 |
| 읽음 확인 | 상대방 읽음 표시 |
| 메시지 삭제 | 본인 메시지 삭제 |
| 메시지 검색 | 대화 내용 검색 |
| 답장 | 특정 메시지에 답장 |
| 이모지 반응 | 메시지에 이모지 반응 |

### 그룹 관리

| 기능 | 설명 |
|------|------|
| 멤버 초대 | 그룹에 사용자 초대 |
| 멤버 강퇴 | 관리자가 멤버 강퇴 |
| 권한 관리 | 관리자 권한 부여/해제 |
| 그룹 나가기 | 채팅방 퇴장 |

---

## 기존 스터디 채팅과의 차이점

| 구분 | 스터디 채팅 (기존) | DM/그룹 채팅 (신규) |
|------|-------------------|---------------------|
| 범위 | 스터디 멤버 전용 | 모든 사용자 (친구/비친구) |
| 접근 | 스터디 가입 필수 | 자유롭게 생성 |
| 목적 | 스터디 협업 | 개인 소통 |
| 권한 | 스터디 역할 기반 | 채팅방 역할 기반 |
| 1:1 | 미지원 | 지원 |
| 파일 | 스터디 파일함 연동 | 독립적 파일 관리 |

---

## 기술 스택

| 영역 | 기술 |
|------|------|
| 실시간 통신 | Socket.IO |
| 데이터베이스 | PostgreSQL + Prisma |
| 파일 저장 | 로컬 스토리지 / S3 |
| 이미지 처리 | Sharp (썸네일 생성) |
| 알림 | Web Push API |

---

## 페이지 구조

| 경로 | URL | 설명 |
|------|-----|------|
| `src/app/messages/page.jsx` | `/messages` | 채팅방 목록 |
| `src/app/messages/[roomId]/page.jsx` | `/messages/[roomId]` | 채팅방 |
| `src/app/messages/new/page.jsx` | `/messages/new` | 새 대화 시작 |
| `src/app/messages/new/group/page.jsx` | `/messages/new/group` | 그룹 채팅 생성 |

---

## 구현 우선순위

| Phase | 기능 | 예상 기간 |
|-------|------|----------|
| 1 | 1:1 채팅 기본 (텍스트) | 3일 |
| 2 | 실시간 메시지 송수신 | 2일 |
| 3 | 읽음 확인 | 1일 |
| 4 | 그룹 채팅방 생성/관리 | 3일 |
| 5 | 파일/이미지 전송 | 2일 |
| 6 | 답장, 이모지 반응 | 2일 |
| 7 | 메시지 검색 | 1일 |
| 8 | 타이핑 표시, 고급 기능 | 2일 |

---

## 관련 문서

- [09-chat](../09-chat/README.md) - 기존 스터디 채팅
- [21-friends](../21-friends/README.md) - 친구 시스템
- [08-notifications](../08-notifications/README.md) - 알림 시스템
- [10-files](../10-files/README.md) - 파일 시스템

